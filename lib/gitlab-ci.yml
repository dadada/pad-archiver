stages:
  - update

update:
  image: git.fginfo.tu-bs.de:5050/fginfo/pad-archiver:main
  tags:
    - docker
  stage: update
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
  before_script:
    - git config --global user.email "git@git.fginfo.tu-bs.de"
    - git config --global user.name "Gitlab CI"
  script:
    - /update < pads.txt
    - git push "https://gitlab-ci-token:${CI_ACCESS_TOKEN}@${CI_REPOSITORY_URL#*@}" "HEAD:${CI_COMMIT_REF_NAME}" -o skip-ci
